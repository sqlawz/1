# Установка и настройка необходимых пакетов

❗❗❗ Подключаемся по SSH на `HQ-SRV`, вводим пароль, и входим в привилегированный режим командой `sudo su` ❗❗❗

### Вариант 1

`ssh sshuser@192.168.100.2 -p 2024`

### Вариант 2

`ssh sshuser@192.168.10.2 -p 3015`

![{EB2701EB-7B36-434D-AFEB-DAA2350781E9}](https://github.com/user-attachments/assets/51a9741a-2924-454c-a886-77a72922cef7)

Устанавливаем пакеты 

`apt install apache2 mariadb-server php libapache2-mod-php php-mysql php-curl php-zip php-xml php-mbstring php-gd php-intl php-soap php-ldap php-bcmath -y`

Переходим в оболочку СУБД

`mysql`

![{68D718A4-63DB-4D08-9713-A33657DD3ED9}](https://github.com/user-attachments/assets/1f14af22-8933-4602-bb79-b7761373d709)

Создаём базу данных

`CREATE DATABASE moodledb;`

Создаём пользователя

`CREATE USER 'moodle'@'localhost' IDENTIFIED BY 'P@ssw0rd';`

Даём все права на базу данных

`GRANT ALL PRIVILEGES ON moodledb.* TO 'moodle'@'localhost';`

Применяем изменения

`FLUSH PRIVILEGES;`

Выходим

`EXIT;`

Далее переходим в конфиг `php.ini` и добавляем строку `max_input_vars=6000`

`nano /etc/php/8.2/apache2/php.ini`

![{E3C5F288-EDFA-49AD-96E5-41FCE40BEB71}](https://github.com/user-attachments/assets/065e9c00-4b82-4d36-a2ec-8176357e6e5d)

Перезапускаем `apache2`

`systemctl restart apache2`

# Поиск moodle

***
❗❗❗ МОЖНО ПРОПУСТИТЬ, ПЕРЕЙДЯ К РАЗДЕЛУ [Установка moodle](https://github.com/ewkerewka/demo2025/wiki/2.7-Moodle#%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0-moodle) ❗❗❗
***

Заходим в браузер и пишем в поиске "moodle download" и переходим по ссылке на экране

![{6ECCED61-A77E-458E-996D-DB970F599365}](https://github.com/user-attachments/assets/09739c77-41b0-4a0a-a069-35d8f84e3d1b)

Переходим в раздел с загрузками

![{DB9D6DEA-1C47-45E0-8534-B7C309A0FC3A}](https://github.com/user-attachments/assets/fe2f28b6-824f-464a-967b-949154cfd69d)

Нажимаем и скачиваем

![{43DA9C92-1D58-4DBD-B29A-DB24E3EC90FD}](https://github.com/user-attachments/assets/d8524863-ab77-48b9-9e27-f6c9fce30c7b)

После у нас открывается окно загрузок и нажимаем "Копировать ссылку на загрузку"

![{4C49A9BD-0179-49FE-A06D-20B70D575122}](https://github.com/user-attachments/assets/9bbb6828-9076-4bde-b51d-af7c0319f81f)

После скачиваем moodle с помощью `wget`, вставив ссылку в терминал

# Установка moodle

`wget https://packaging.moodle.org/stable405/moodle-latest-405.tgz`

Распаковываем архив 

`tar -xzvf moodle-latest-405.tgz `

Перемещаем директорию `moodle`

`mv moodle /var/www/html/`

Устанавливаем права

`chown -R www-data:www-data /var/www/html/moodle`

`chmod -R 755 /var/www/html/moodle`

Создаём каталог для файлов пользователей

`mkdir /var/moodledata`

Задаём ему права

`chown -R www-data:www-data /var/moodledata`

`chmod -R 755 /var/moodledata`

Создаём конфиг `apache` для `moodle`

`nano /etc/apache2/sites-available/moodle.conf`

### Вариант 1

```
<VirtualHost *:80>
        DocumentRoot /var/www/html/moodle
        ServerName 192.168.100.2
        ServerAlias moodle.au-team.irpo

<Directory /var/www/html/moodle>
        Options FollowSymlinks
        AllowOverride All
        Require all granted
</Directory>

        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost> 
```

### Вариант 2
```
<VirtualHost *:80>
        DocumentRoot /var/www/html/moodle
        ServerName 192.168.10.2
        ServerAlias moodle.au-team.irpo

<Directory /var/www/html/moodle>
        Options FollowSymlinks
        AllowOverride All
        Require all granted
</Directory>

        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost> 
```

![{31B0988A-A0CC-48E5-A73F-CC60FD2B7955}](https://github.com/user-attachments/assets/7a9435f3-3ca4-43be-8422-7a5dc5634ded)

Активируем конфигурацию

`a2ensite moodle.conf`

`a2enmod rewrite`

`systemctl restart apache2`

После на HQ-CLI переходим по адресу HQ-SRV ( `http://192.168.100.2` или `http://192.168.10.2` ) и должен открыться `moodle`, выбираем язык установки Русский, жмём Далее

>![{8A6889BE-B28C-491B-8490-8B228A68FEF2}](https://github.com/user-attachments/assets/0207ff5c-89a7-416e-a80d-1dbafef7f8e3)

---

>![{F6CCA99A-E21A-4B70-83CE-54F5D0262484}](https://github.com/user-attachments/assets/24ac7fd8-fa3e-4bd5-8dec-10b6ce1edf0e)

---

>![{BD718F09-3942-4AEC-9F39-FF0017A05684}](https://github.com/user-attachments/assets/12934243-9420-4a36-bad3-4113f7c84d51)

---

>![{7CC1503A-6392-4BB0-92C9-209DC3EC711D}](https://github.com/user-attachments/assets/4cdeef8e-0b93-4d65-850a-b63f1bfb3b1a)

---

>![{C24715FA-EE2A-4BC9-9C4E-75FEBD920646}](https://github.com/user-attachments/assets/bc700ee0-dbf1-4c63-a7d0-e5859828ad4e)

---

>![{5CA252AD-5780-4AE3-B767-A870AD076B78}](https://github.com/user-attachments/assets/a00c5cb8-b93d-4eef-b769-1eaac1c2e3d6)

---

>![{7AA1A2EA-123D-44AF-9167-BF5818968094}](https://github.com/user-attachments/assets/8713d9e2-18d5-4a64-8e5e-2a6f942e3d21)

---

>![{40558AC5-8364-401D-8C73-15BD6BF130FA}](https://github.com/user-attachments/assets/d4db0bf7-2105-41b6-8499-921ea4f836f9)

---
Вписываем номер рабочего места

>![{10A1877F-D08F-43D1-8F9C-E8A028C86EFA}](https://github.com/user-attachments/assets/94a7f708-260a-4e5d-a5c7-974fa2aa6c4b)

---

>![{C407B7A3-2947-434A-9AC2-18E8724A7701}](https://github.com/user-attachments/assets/b6a3774c-e8b3-4a75-b314-e3d46a5ea5dd)

---

>![{74EE1197-0BDD-4EFC-8E31-9334C7336A96}](https://github.com/user-attachments/assets/2c99036f-dbb5-43fd-a78f-ff3c153fbe0d)

---

>![{CF34F4A0-59D3-4D6C-848B-047CF29199DF}](https://github.com/user-attachments/assets/fcd85237-b18d-4e30-81b1-b46b3c3ba5c4)












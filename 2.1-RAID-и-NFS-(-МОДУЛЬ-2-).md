# RAID

Настройку выполняем на HQ-SRV

Устанавливаем утилиту `mdadm`

`apt install mdadm`

Выведем список дисков командой `lsblk`

![{56466168-D954-42D8-A134-1D823B0E4C9C}](https://github.com/user-attachments/assets/8ff6de67-ed07-4493-b74f-f8675aaae463)

Создадим массив

`mdadm --create --verbose /dev/md0 -l 5 -n 3 /dev/sd{b,c,d}`

Проверим массив, введя снова команду `lsblk`

![{DD29C38F-36BD-4015-A095-73B1DF69CFD7}](https://github.com/user-attachments/assets/3876729a-0b57-4b98-9202-4123971a4be7)


Сохраним конфигурацию массива

`mdadm --detail --scan | tee /etc/mdadm.conf`

`update-initramfs -u`

Создаём раздел и форматируем его в ext4

`mkfs.ext4 /dev/md0`

Создаём директорию и монтируем в неё массив

`mkdir /raid5`

`mount /dev/md0 /raid5`

Настроим автоматическое монтирование

`echo '/dev/md0 /raid5 ext4 defaults 0 0' | tee -a /etc/fstab`

# NFS server ( HQ-SRV )

Устанавливаем `nfs-kernel-server`

`apt install nfs-kernel-server`

`mkdir /raid5/nfs`

Настроим экспорт массива

`echo '/raid5/nfs 192.168.200.0/28(rw,sync,no_subtree_check)' | tee -a /etc/exports`

Перезапускаем nfs-kernel-server

`systemctl restart nfs-kernel-server`

# NFS client ( HQ-CLI )

Устанавливаем nfs клиент

`apt install nfs-common`

Создаём директорию для монтирования

`mkdir /mnt/nfs`

Настроим автоматическое монтирование

`echo '192.168.100.2:/raid5/nfs /mnt/nfs nfs defaults 0 0' | tee -a /etc/fstab`

Монтируем

`mount -a`